<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DeenMate</title>
  <link rel="icon" type="image/png" href="./decorative-arabic-lamp-free-vector.jpg">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    /* Basic reset and background styling */
    body {
      margin: 0;
      font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
      background-color: rgb(173, 229, 230);
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    /* Container wrapping the left image and chat layout */
    #chatContainer {
      display: flex;
      flex-direction: column; /* Stack elements on mobile */
      align-items: center;
     width: 100%;
      height: auto;
      position: relative;
      top: auto;
      left: auto;
      transform: none;
      padding: 10px;
    }
    /* Styling for the left image with custom size and left-side decoration */
    .chat-image {
      width: 100%; /* Full width on small screens */
  max-width: 150px; /* Limit maximum size */
  height: auto;
  margin-bottom: 10px;
          /* Custom height */
      object-fit: cover;   /* Ensures the image covers the area */
      margin-right: 20px;
      padding: 5px;
      border: 2px solid #ccc;
      border-radius: 10px;
      /* Optionally add a background or shadow if desired */
      background-color: #fff;
    }
    /* Main chat area styling with increased height */
    #main {
      width: 95%; /* Reduce width for better fit */
  max-width: 670px;
  height: auto;
       /* Increased height */
      display: flex;
      flex-direction: column;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      background-color: #daffea;
      border-radius: 19px;
      overflow: hidden;
    }
    /* Chat header styling with custom background color */
    .chat-header {
      padding: 20px;
      background-color: #00e5ff; /* Custom background color */
      font-size: 1.7em;
      font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
      text-align: center;
      color: #073314;
    }
    /* Chat messages area styling */
    #chatMessages {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
    }
    .message {
      margin-bottom: 15px;
      padding: 10px 15px;
      border-radius: 10px;
      max-width: 70%;
      word-wrap: break-word;
      font-size: 0.8em;
      line-height: 1.5;
    }
    .user-message {
      background-color: #0c2b12;
      color: #fff;
      margin-left: auto;
      animation: slideInRight 0.3s ease-out;
    }
    .bot-message {
      background-color: #f1f1f1;
      color: #0c2b12;
      margin-right: auto;
      animation: slideInLeft 0.3s ease-out;
    }
    @keyframes slideInRight {
      from { opacity: 0; transform: translateX(20px); }
      to { opacity: 1; transform: translateX(0); }
    }
    @keyframes slideInLeft {
      from { opacity: 0; transform: translateX(-20px); }
      to { opacity: 1; transform: translateX(0); }
    }
    /* Input area styling */
    #inputArea {
      padding: 20px;
      border-top: 2px solid #16ebbd;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    #userInput {
      flex: 1;
      padding: 20px;
      font-size: 14px;
      border: 1px solid #ccc;
      border-radius: 19px;
      outline: none;
    }
    #sendBtn {
      background-color: #0c2b12;
      color: #fff;
      border: none;
      border-radius: 19px;
      cursor: pointer;
      padding: 12px 20px;
      font-size: 14px;
      transition: background-color 0.3s ease;
    }
    #sendBtn:hover {
      background-color: #0e8a70;
    }
    /* Pre-questions container styling */
    #preQuestions {
      padding: 10px 20px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    #preQuestions button {
      font-size: 12px;
      border: 1px solid #cccccc;
      border-radius: 19px;
      outline: none;
      cursor: pointer;
    }
    /* Typing indicator styling */
    .typing-indicator {
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    .typing-indicator span {
      display: inline-block;
      width: 10px;
      height: 10px;
      margin: 0 3px;
      background-color: #aaa;
      border-radius: 50%;
      opacity: 0.4;
      animation: blink 1s infinite;
    }
    .typing-indicator span:nth-child(2) {
      animation-delay: 0.2s;
    }
    .typing-indicator span:nth-child(3) {
      animation-delay: 0.4s;
    }
    @keyframes blink {
      0% { opacity: 0.4; }
      20% { opacity: 1; }
      100% { opacity: 0.4; }
    }
    /* CSS for Footer */
footer {
  position: fixed;
  bottom: 0;
  width: 100%;
  height: auto;
    /* Customize background color */
  text-align: center;
  padding: 10px 0;
  color: #005451;
  font-size: 0.7em;
  
}
@media screen and (max-width: 768px) {
  #chatContainer {
    flex-direction: column;
    align-items: center;
    width: 100%;
    height: auto;
  }
  .chat-image {
    max-width: 120px; /* Reduce image size */
    height: auto;
    margin-right: 0;
  }
  #main {
    width: 95%;
    height: auto;
  }
  #inputArea {
    flex-direction: column; /* Stack input and button */
    gap: 5px;
  }
  #userInput {
    width: 100%;
  }
  #sendBtn {
    width: 100%;
  }
}
footer {
  position: sticky;
  bottom: 0;
}
html, body {
  height: 100%;
  margin: 0;
  display: flex;
  flex-direction: column;
}

#chatContainer {
  flex: 1; /* This makes sure chatContainer takes up remaining space */
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

footer {
  width: 100%;
  text-align: center;
  padding: 10px 0;
  background-color: #00696d;
  color: #00fff7;
  font-size: 0.7em;
  position: relative; /* Change this from fixed */
  bottom: 0;
}


  </style>
</head>
<body>
  <!-- Container for the left image and chatbot -->
  <div id="chatContainer">
    <!-- Left image fixed with the chatbot -->
    <img src="./Fraccm.jpg" alt="Left Image" class="chat-image">
    <!-- Main Chat Area -->
    <div id="main">
      <!-- Chat header without frame -->
      <div class="chat-header">DeenMate</div>
      <div id="chatMessages"></div>
      <!-- Pre-questions above input -->
      <div id="preQuestions">
        <button onclick="selectPreQuestion('is there any exception in fasting?')">is there any exception in fasting?</button>
        <button onclick="selectPreQuestion('ifatr ki dua (roaman english and arebic and meaning)')">ifatr ki dua</button>
        <button onclick="selectPreQuestion('ಎಂಜಿಲು ನುಂಗುವುದರಿಂದ ನಮ್ಮ ಉಪವಾಸ ಮುರಿಯುತ್ತದೆಯೇ?')">ಎಂಜಿಲು ನುಂಗುವುದರಿಂದ ನಮ್ಮ ಉಪವಾಸ ಮುರಿಯುತ್ತದೆಯೇ?</button>
      </div>
      <div id="inputArea">
        <input type="text" id="userInput" placeholder="Type your message..." />
        <button id="sendBtn" onclick="sendMessage()">Send</button>
      </div>
    </div>
  </div>

  <!-- Include Marked.js to convert Markdown to HTML -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>
  <script>
    const OPENROUTER_API_KEY = "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";
    const OPENROUTER_API_URL = "https://openrouter.ai/api/v1/chat/completions";
    
    let typingIndicatorElem = null;

    function appendMessage(message, isUser) {
      const chatMessages = document.getElementById('chatMessages');
      const messageDiv = document.createElement('div');
      messageDiv.className = `message ${isUser ? 'user-message' : 'bot-message'}`;
      messageDiv.innerHTML = marked.parse(message);
      chatMessages.appendChild(messageDiv);
      chatMessages.scrollTop = messageDiv.offsetTop;
    }
    
    function showTypingIndicator() {
      const chatMessages = document.getElementById('chatMessages');
      typingIndicatorElem = document.createElement('div');
      typingIndicatorElem.className = 'message bot-message';
      
      const indicator = document.createElement('div');
      indicator.className = 'typing-indicator';
      for (let i = 0; i < 3; i++) {
        const dot = document.createElement('span');
        indicator.appendChild(dot);
      }
      typingIndicatorElem.appendChild(indicator);
      chatMessages.appendChild(typingIndicatorElem);
      chatMessages.scrollTop = typingIndicatorElem.offsetTop;
    }
    
    function removeTypingIndicator() {
      if (typingIndicatorElem) {
        typingIndicatorElem.remove();
        typingIndicatorElem = null;
      }
    }
    
    function selectPreQuestion(question) {
      document.getElementById('preQuestions').style.display = 'none';
      document.getElementById('userInput').value = question;
      sendMessage();
    }
    
    async function sendMessage() {
      const userInput = document.getElementById('userInput');
      const message = userInput.value.trim();
      if (!message) return;
      
      appendMessage(message, true);
      userInput.value = '';
      showTypingIndicator();
      
      try {
        const response = await fetch(OPENROUTER_API_URL, {
          method: "POST",
          headers: {
            "Authorization": `Bearer ${OPENROUTER_API_KEY}`,
            "HTTP-Referer": window.location.href,
            "X-Title": "Chatbot",
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            "model": "deepseek/deepseek-chat:free",
            "messages": [
              { "role": "system", "content": "You are an Islamic rule based chatbot. Please ensure your responses adhere strictly to Islamic teachings and guidelines. You have knowledge about hadith and Quran, so you can also provide the proof from the verses of Quran." },
              { "role": "user", "content": message }
            ]
          })
        });
        
        const data = await response.json();
        const botResponse = data.choices[0].message.content;
        await new Promise(resolve => setTimeout(resolve, 2000));
        removeTypingIndicator();
        appendMessage(botResponse, false);
      } catch (error) {
        console.error("Error fetching response from OpenRouter API:", error);
        removeTypingIndicator();
        appendMessage("Sorry, I encountered an error. Please try again.", false);
      }
    }
    
    document.getElementById('userInput').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        e.preventDefault();
        sendMessage();
      }
    });
    
    window.onload = function() {
      appendMessage("📢 Assalamu Alaikum! 🤲✨ I'm here to help answer your questions about Islam. May Allah (SWT) bless you with knowledge and guidance. 😊🌟", false);
    }
  </script>
  
<footer>
  <p>&copy; 2025 DeenMate. All Rights Reserved. created by eisa</p>
</footer>
</body>
</html>
